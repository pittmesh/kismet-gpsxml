#!/usr/bin/env ruby

require 'kismet-gpsxml'

DEFAULT_ROUNDING = 4

unless ARGV[0]
  $stderr.puts "Usage: #{__FILE__} logfile.gpsxml [rounding-level]\nDefault rounding-level is #{DEFAULT_ROUNDING} decimal places."
  exit 1
end

file = ARGV[0]
rounding = ARGV[1] ? ARGV[1].to_i : DEFAULT_ROUNDING

reader = Kismet::GPSXML::Reader.from_io File.open(file)
reader.rounding = rounding

points = reader.points

points.each do |point,set|
  puts [point, set.size].join(",")
end
